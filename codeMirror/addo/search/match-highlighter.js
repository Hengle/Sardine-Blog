(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(J){var H=2;var A="matchhighlight";var G=100;var B=false;function E(L){if(typeof L=="object"){this.minChars=L.minChars;this.style=L.style;this.showToken=L.showToken;this.delay=L.delay;this.wordsOnly=L.wordsOnly}if(this.style==null){this.style=A}if(this.minChars==null){this.minChars=H}if(this.delay==null){this.delay=G}if(this.wordsOnly==null){this.wordsOnly=B}this.overlay=this.timeout=null}J.defineOption("highlightSelectionMatches",false,function(N,M,L){if(L&&L!=J.Init){var O=N.state.matchHighlighter.overlay;if(O){N.removeOverlay(O)}clearTimeout(N.state.matchHighlighter.timeout);N.state.matchHighlighter=null;N.off("cursorActivity",I)}if(M){N.state.matchHighlighter=new E(M);F(N);N.on("cursorActivity",I)}});function I(L){var M=L.state.matchHighlighter;clearTimeout(M.timeout);M.timeout=setTimeout(function(){F(L)},M.delay)}function F(L){L.operation(function(){var Q=L.state.matchHighlighter;if(Q.overlay){L.removeOverlay(Q.overlay);Q.overlay=null}if(!L.somethingSelected()&&Q.showToken){var M=Q.showToken===true?/[\w$]/:Q.showToken;var T=L.getCursor(),N=L.getLine(T.line),O=T.ch,P=O;while(O&&M.test(N.charAt(O-1))){--O}while(P<N.length&&M.test(N.charAt(P))){++P}if(O<P){L.addOverlay(Q.overlay=C(N.slice(O,P),M,Q.style))}return}var S=L.getCursor("from"),U=L.getCursor("to");if(S.line!=U.line){return}if(Q.wordsOnly&&!K(L,S,U)){return}var R=L.getRange(S,U).replace(/^\s+|\s+$/g,"");if(R.length>=Q.minChars){L.addOverlay(Q.overlay=C(R,false,Q.style))}})}function K(Q,L,M){var O=Q.getRange(L,M);if(O.match(/^\w+$/)!==null){if(L.ch>0){var N={line:L.line,ch:L.ch-1};var P=Q.getRange(N,L);if(P.match(/\W/)===null){return false}}if(M.ch<Q.getLine(L.line).length){var N={line:M.line,ch:M.ch+1};var P=Q.getRange(M,N);if(P.match(/\W/)===null){return false}}return true}else{return false}}function D(M,L){return(!M.start||!L.test(M.string.charAt(M.start-1)))&&(M.pos==M.string.length||!L.test(M.string.charAt(M.pos)))}function C(M,N,L){return{token:function(O){if(O.match(M)&&(!N||D(O,N))){return L}O.next();O.skipTo(M.charAt(0))||O.skipToEnd()}}}});