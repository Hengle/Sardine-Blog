(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("htmlmixed",function(B,H){var G=A.getMode(B,{name:"xml",htmlMode:true,multilineTagIndentFactor:H.multilineTagIndentFactor,multilineTagIndentPastTag:H.multilineTagIndentPastTag});var C=A.getMode(B,"css");var E=[],D=H&&H.scriptTypes;E.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:A.getMode(B,"javascript")});if(D){for(var F=0;F<D.length;++F){var M=D[F];E.push({matches:M.matches,mode:M.mode&&A.getMode(B,M.mode)})}}E.push({matches:/./,mode:A.getMode(B,"text/plain")});function L(T,Q){var N=Q.htmlState.tagName;if(N){N=N.toLowerCase()}var P=G.token(T,Q.htmlState);if(N=="script"&&/\btag\b/.test(P)&&T.current()==">"){var S=T.string.slice(Math.max(0,T.pos-100),T.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);S=S?S[1]:"";if(S&&/[\"\']/.test(S.charAt(0))){S=S.slice(1,S.length-1)}for(var O=0;O<E.length;++O){var R=E[O];if(typeof R.matches=="string"?S==R.matches:R.matches.test(S)){if(R.mode){Q.token=J;Q.localMode=R.mode;Q.localState=R.mode.startState&&R.mode.startState(G.indent(Q.htmlState,""))}break}}}else{if(N=="style"&&/\btag\b/.test(P)&&T.current()==">"){Q.token=K;Q.localMode=C;Q.localState=C.startState(G.indent(Q.htmlState,""))}}return P}function I(R,O,P){var N=R.current();var Q=N.search(O);if(Q>-1){R.backUp(N.length-Q)}else{if(N.match(/<\/?$/)){R.backUp(N.length);if(!R.match(O,false)){R.match(N)}}}return P}function J(O,N){if(O.match(/^<\/\s*script\s*>/i,false)){N.token=L;N.localState=N.localMode=null;return null}return I(O,/<\/\s*script\s*>/,N.localMode.token(O,N.localState))}function K(O,N){if(O.match(/^<\/\s*style\s*>/i,false)){N.token=L;N.localState=N.localMode=null;return null}return I(O,/<\/\s*style\s*>/,C.token(O,N.localState))}return{startState:function(){var N=G.startState();return{token:L,localMode:null,localState:null,htmlState:N}},copyState:function(O){if(O.localState){var N=A.copyState(O.localMode,O.localState)}return{token:O.token,localMode:O.localMode,localState:N,htmlState:A.copyState(G,O.htmlState)}},token:function(O,N){return N.token(O,N)},indent:function(O,N){if(!O.localMode||/^\s*<\//.test(N)){return G.indent(O.htmlState,N)}else{if(O.localMode.indent){return O.localMode.indent(O.localState,N)}else{return A.Pass}}},innerMode:function(N){return{state:N.localState||N.htmlState,mode:N.localMode||G}}}},"xml","javascript","css");A.defineMIME("text/html","htmlmixed")});